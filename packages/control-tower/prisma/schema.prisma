generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Airport {
  country     String
  name        String
  controllers Controller[]
  Ground      Ground?
  ILSs        ILS?
  SIDs        SID[]

  @@id([country, name])
}

model Waypoint {
  name           String      @unique
  sIDId          String?
  AirportName    String?
  ControllerName String?
  Country        String
  Ground         Ground?     @relation(fields: [groundCountry, groundAirportName], references: [Country, AirportName])
  ILS            ILS?        @relation(fields: [iLSAirportCountry, iLSAirportName], references: [AirportCountry, AirportName])
  Controller     Controller? @relation(fields: [controllerAirportCountry, controllerAirportName, controllerName], references: [AirportCountry, AirportName, Name])
  SID            SID?        @relation(fields: [sIDAirportCountry, sIDAirportName], references: [AirportCountry, AirportName])
  Airplane       Airplane?

  groundCountry            String?
  groundAirportName        String?
  iLSAirportCountry        String?
  iLSAirportName           String?
  controllerAirportCountry String?
  controllerAirportName    String?
  controllerName           String?
  sIDAirportCountry        String?
  sIDAirportName           String?
  @@id([Country, name])
}

model ILS {
  AirportCountry     String
  AirportName        String
  Airport            Airport    @relation(fields: [AirportCountry, AirportName], references: [country, name])
  waypoints_by_order Waypoint[]

  @@id([AirportCountry, AirportName])
}

model Controller {
  RF             RF
  Name           String
  AirportCountry String
  AirportName    String
  Airport        Airport    @relation(fields: [AirportCountry, AirportName], references: [country, name])
  Waypoints      Waypoint[]

  @@id([AirportCountry, AirportName, Name])
}

model SID {
  AirportCountry     String
  AirportName        String
  Airport            Airport    @relation(fields: [AirportCountry, AirportName], references: [country, name])
  waypoints_by_order Waypoint[]

  @@id([AirportCountry, AirportName])
}

model Ground {
  Country     String
  AirportName String
  Airport     Airport    @relation(fields: [Country, AirportName], references: [country, name])
  waypoints   Waypoint[]

  @@id([Country, AirportName])
}

model Airplane {
  id           String   @id @default(uuid())
  create_at    DateTime @default(now())
  waypointName String
  Country      String
  Waypoint     Waypoint @relation(fields: [Country, waypointName], references: [Country, name])
  valid        Boolean  @default(true)

  @@unique([Country, waypointName])
}

model Message {
  id      String   @id
  from    String
  to      String?
  content String
  sent_at DateTime @default(now())
  rf      RF
}

enum RF {
  F120D5
  F121D4
  F134D6
}
